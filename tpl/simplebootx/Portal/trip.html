<tc_extend name="Public/layout"/>
<block name="css">
    <!--<link href="__TMPL__Portal/css/travel.css" rel="stylesheet">-->
<style>
    .welcome-banner{
        height: 600px;
        background-image: none;
        background-size: cover;
        background-repeat: no-repeat;
        padding-top: 260px;
    }
    .welcome-banner .slogan-block {
        position: relative;
        width: 520px;
        height: 160px;
        background-color: rgba(0,0,0,0.6);
        padding-top: 40px;
        border-radius: 4px;
    }
    .welcome-banner .slogan-block .faq-block {
        margin-top: 24px;
        width: 315px;
    }
    .welcome-banner .slogan-block h1 {
        font-size: 24px;
        color: #fff;
        margin: 0;
    }
    .welcome-banner .slogan-block .faq-block .faq-btn {
        display: inline-block;
        height: 38px;
        width: 138px;
        line-height: 38px;
        background-color: rgba(255,255,255,0);
        color: #fff;
        font-size: 14px;
        border: 1px solid #fff;
        border-radius: 4px;
        text-align: center;
        text-decoration: none;
        -webkit-transition: all 0.5s;
        transition: all 0.5s;
    }

    .welcome-introduction .intro-row {
        border-bottom: 1px solid #ebeae9;
        padding-bottom: 40px;
    }
    .welcome-introduction .intro-block img {
        display: block;
        width: 180px;
        margin: 0 auto;
    }
    .welcome-introduction .intro-block .title {
        font-size: 22px;
        color: #3c3931;
        text-align: center;
    }
    .welcome-introduction .intro-block p {
        text-align: center;
        font-size: 14px;
        color: #9c968f;
        margin: 3px;
    }

    .enter_box{
        width:100%;
        top: 0px;
        left: 0px;
        background: #ffffff;
        position: absolute;
        z-index: 999;
    }
    .enter_box img{
        opacity: 0;
        z-index: 1000;
        position: absolute;
    }
    .enter_box .rqq{
        left: 250px;
        position: absolute;
        bottom: 0px;
        height: 200px;
    }

    .enter_box .text1{
        left: 450px;
        position: absolute;
        width: 100px;
    }
    .enter_box a{
        opacity: 0;
        z-index: 1000;
        position: absolute;
        display: inline-block;
        width: 158px;
        height: 46px;
        color: #ffffff;
        font-size: 18px;
        background-color: darkgreen;
        line-height: 46px;
        text-align: center;
        border-radius: 6px;
        text-decoration: none;
        left: 650px;
        bottom: 150px;
    }

    .content_box{
        /*background: url('/tpl/simplebootx/Public/images/content_bg.png') center no-repeat;*/
        height:674px;
        position: relative;
        text-align: center;
    }
    .content_box img.city_map{
        margin: 0 auto;
        z-index: -1;
        max-width:none;
    }
    .content_box .btn_ball_box{
        position: absolute;
        width: 110px;
        height: 138px;
        z-index: 2;
    }
    .btn_ball_box img{
        position: absolute;
        top:0px;
    }
    .container {
        position: relative;
        box-sizing: border-box;
    }
    .container {
        padding-right: 15px;
        padding-left: 15px;
        margin-right: auto;
        margin-left: auto;
    }
    @media screen and (min-width: 768px) {
        .container {
            width: 750px;
        }
    }

    @media screen and (min-width: 992px) {
        .container {
            width: 970px;
        }
    }

    @media screen and (min-width: 1200px) {
        .container {
            width: 1170px;
        }
    }
    .info-container {
        display: none;
        color: #534641;
        border-bottom: 1px solid #d8d8d8;
        padding-left: 20px;
        margin-bottom: 30px;
    }
    .info-container .place-title {
        display: inline-block;
        margin: 20px 40px 0 0;
    }
    .info-container .place-title .place-zh {
        font-size: 26px;
        margin: 3px 0;
    }
    .info-container .place-title .place-en {
        font-size: 38px;
        margin: 3px 0;
        font-weight: bold;
    }
    .info-container .place-info {
        display: inline-block;
        font-size: 14px;
    }
    .info-container .place-info .divide {
        display: inline-block;
        margin: 0 10px;
    }
    .pois-container .poi-item {
        position: relative;
        float: left;
        overflow: hidden;
        margin-right: 20px;
        margin-bottom: 20px;
        box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.2);
        cursor: pointer;
    }
    .pois-container .poi-item .poi-img img {
        -webkit-transition: all 1s;
        transition: all 0.5s;
    }
    .pois-container .poi-item .poi-name {
        position: absolute;
        bottom: 0px;
        left: 0px;
        color: #fff;
        font-size: 14px;
        text-shadow: 1px 1px 0px rgba(0, 0, 0, 0.3);
        padding: 12px;
        width: 100%;
    }
    .more-pois-btn {
        display: none;
        text-align: center;
        padding: 10px;
        font-size: 18px;
        color: #969696;
        background-color: #fff;
        border-radius: 4px;
        cursor: pointer;
        margin: 10px 20px 0;
        box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.2);
    }
    .pois-container{
        height: auto;
    }
    .poi-row{
        height: auto;
    }
</style>
</block>
<block name="content">
    <div class="row">
        <div class="content_box">
            <img src="__TMPL__Public/images/content_bg.png" class="city_map" usemap="#citymap" style="height: 674px;width: 1227px;" />
            <map name="citymap" id="citymap">
                <area shape="circle" coords="290,190,100" href ="javascript:fly(0)" style="cursor: pointer;" alt="纽约" title="纽约"/>
                <area shape="circle" coords="530,270,60" href ="javascript:fly(1)" style="cursor: pointer" alt="伦敦"  title="伦敦" />
                <area shape="circle" coords="660,270,55" href ="javascript:fly(2)" style="cursor: pointer" alt="希腊"  title="希腊"  />
                <area shape="circle" coords="860,360,60" href ="javascript:fly(3)" style="cursor: pointer" alt="泰国"  title="泰国"  />
                <area shape="circle" coords="980,496,55" href ="javascript:fly(4)" style="cursor: pointer" alt="悉尼"  title="悉尼"  />
                <area shape="circle" coords="1110,540,60" href ="javascript:fly(5)" style="cursor: pointer" alt="新西兰"  title="新西兰"  />
                <area shape="circle" coords="1058,306,60" href ="javascript:fly(6)" style="cursor: pointer" alt="日本"  title="日本"  />
                <area shape="circle" coords="685,150,60" href ="javascript:fly(7)" style="cursor: pointer" alt="芬兰"  title="芬兰"  />
                <area shape="circle" coords="540,140,60" href ="javascript:fly(8)" style="cursor: pointer" alt="冰岛"  title="冰岛"  />
            </map>
            <div class="btn_ball_box">
                <img src="__TMPL__Public/images/btn_ball.png" >
            </div>
        </div>
        <div class="container">
            <div class="info-container" style="display: none;" id="info-container">
                <div class="place-title">
                    <h1 class="place-zh"></h1>

                    <h2 class="place-en"></h2>
                </div>
                <div class="place-info">
                    <p>推荐天数：<span class="advice-date"></span><span class="divide">|</span>适宜季节：<span
                            class="best-season"></span>
                    </p>
                </div>
            </div>
            <div class="pois-container clearfix" style="padding: 0px 10px;display: none;">
                <div class="poi-row clearfix" id="poi-row" style="position: relative">
                </div>
            </div>
            <div class="more-pois-btn" data-skip="11" data-destination-id="3" style="display: none;">加载更多</div>
        </div>
    </div>
    <!--<div class="enter_box">
        <img src="__TMPL__Public/images/rqq.png" class="rqq" />
        <img src="__TMPL__Public/images/text1.png" class="text1" />
        <img src="__TMPL__Public/images/text2.png" class="text2" />
        <img src="__TMPL__Public/images/text3.png" class="text3" />
        <img src="__TMPL__Public/images/text4.png" class="text4" />
        <img src="__TMPL__Public/images/text5.png" class="text5" />
        <img src="__TMPL__Public/images/text6.png" class="text6" />
        <a href="javascript:enter()" class="tailor-for-me ga-hook" >进入首页</a>
    </div>-->
</block>
<block name="scripts">
    <script type="text/javascript" src="__TMPL__Public/js/blocksit.min.js"></script>
    <script>
        var height=window.innerHeight;
        /*$('.enter_box').css('height',height);
        $(".rqq").animate({
            bottom:'250px',
            opacity:'0.8',
            height:'200px',
        },1000).animate({
            bottom:'260px',
            opacity:'1',
            height:'424px',
        },1000);
        $(".text1").animate({
            left:'750px',
            bottom:'550px',
            opacity:'0',
            width:'360px',
        },1000).animate({
            left:'650px',
            bottom:'600px',
            opacity:'1',
            width:'314px',
        },1000);

        $(".text2").animate({
            left:'750px',
            bottom:'400px',
            opacity:'0',
            width:'200px',
        },2000).animate({
            left:'660px',
            bottom:'510px',
            opacity:'1',
            width:'294px',
        },1000);

        $(".text3").animate({
            left:'650px',
            bottom:'150px',
            opacity:'0',
            width:'360px',
        },3000).animate({
            left:'560px',
            bottom:'380px',
            opacity:'1',
            width:'233px',
        },1000);

        $(".text4").animate({
            left:'650px',
            bottom:'150px',
            opacity:'0',
            width:'300px',
        },4000).animate({
            left:'500px',
            bottom:'290px',
            opacity:'1',
            width:'407px',
        },1000);

        $(".text5").animate({
            left:'1020px',
            bottom:'150px',
            opacity:'0',
            width:'134px',
        },4500).animate({
            left:'950px',
            bottom:'380px',
            opacity:'1',
            width:'234px',
        },1000);

        $(".text6").animate({
            left:'1000',
            bottom:'150px',
            opacity:'0',
            width:'200px',
        },5500).animate({
            left:'920px',
            bottom:'290px',
            opacity:'1',
            width:'384px',
        },1000);
        $(".enter_box a").animate({
            opacity:'0'
        },6500).animate({
            bottom:'160px',
            opacity:'1',
        },500);

        function enter()
        {
            $('.enter_box').hide();
        }*/
        var body_height=$('body').height();
        if(body_height<height)
        {
            $('body').css('height',height);
           $('.footer').css({'position':'absolute','bottom':0,'margin':0,'width':'100%'});
        }
        var width=$('.content_box').width();
        var img_map_left=$('.city_map').offset().left;
        var ball_positions=[
            {left:img_map_left+90,top:120},
            {left:img_map_left+360,top:200},
            {left:img_map_left+550,top:280},
            {left:img_map_left+690,top:290},
            {left:img_map_left+815,top:426},
            {left:img_map_left+1110,top:470},
            {left:img_map_left+1000,top:106},
            {left:img_map_left+710,top:80},
            {left:img_map_left+355,top:60}];
        var ball_init=ball_positions[0];
        $('.btn_ball_box').css(ball_init);

        //初始化各城市位置点
        function fly(i)
        {
            var position=ball_positions[i];
            var id=i+1;
            $('.btn_ball_box').animate(position,2000,function(){
                $.ajax({
                    cache: true,
                    type: "get",
                    url: '/index/area_data?id='+id,
                    async: false,
                    error: function(request) {
                        alert("Connection error");
                    },
                    success: function(data) {
                        if(data.status==1)
                        {
                            $('.info-container').show();
                            $('.info-container .place-title .place-zh').text(data.data.name);
                            $('.info-container .place-title .place-en').text(data.data.full_name);
                            $('.info-container .place-info .advice-date').text(data.data.day);
                            $('.info-container .place-info .best-season').text(data.data.season);
                            //$('.info-container .place-info .estimated-cost').text(data.data.cost);
                        }else{
                            alert(data.info);
                        }
                    }
                });
                destinationDataInit(id);
                $(window).scrollTop(360);
            });
        }

        function destinationDataInit(id)
        {
            $.ajax({
                cache: true,
                type: "get",
                url: '/index/destination_data?id='+id,
                async: false,
                error: function(request) {
                    alert("Connection error");
                },
                success: function(data) {
                    if(data.status==1)
                    {
                        $('.pois-container').show();
                        var html='';
                        $.each(data.data, function(i,obj){
                            html+='<div class="poi-item" data-poi-id="'+obj.id+'" style=" margin: 10px;" onclick="gostory('+obj.id+')">'+
                                    '<div class="poi-img"><img src="'+obj.photo+'"  style="width:100%;"></div>'+
                                    '<div class="poi-name">'+obj.post_title+'</div>'+
                                    '</div>';
                        });
                        $('.pois-container .poi-row').html(html);
                        // 判断图片加载状况，加载完成后回调
                        isImgLoad('.poi-img img',function(){
                            // 加载完成
                            $('.pois-container .poi-row').BlocksIt({numOfCol: 3});
                        });

                    }else{
                        alert(data.info);
                    }
                }
            });
        }

        function gostory(id)
        {
            window.location.href="/stories/"+id;
        }

        setInterval(function(){
            $('.btn_ball_box img').animate({
                top:'-20px'
            },1000).animate({
                top:'0px'
            },1000);
        },2000);


        var t_img; // 定时器
        var isLoad = true; // 控制变量

        // 判断图片加载的函数
        function isImgLoad(imgs,callback){
            // 注意我的图片类名都是cover，因为我只需要处理cover。其它图片可以不管。
            // 查找所有封面图，迭代处理
            $(imgs).each(function(){
                // 找到为0就将isLoad设为false，并退出each
                if(this.height === 0){
                    isLoad = false;
                    return false;
                }
            });
            // 为true，没有发现为0的。加载完毕
            if(isLoad){
                clearTimeout(t_img); // 清除定时器
                // 回调函数
                callback();
                // 为false，因为找到了没有加载完成的图，将调用定时器递归
            }else{
                isLoad = true;
                t_img = setTimeout(function(){
                    isImgLoad(callback); // 递归扫描
                },500); // 我这里设置的是500毫秒就扫描一次，可以自己调整
            }
        }
    </script>
</block>